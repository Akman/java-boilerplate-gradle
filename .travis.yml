# if: tag IS blank

#
# https://jdk.java.net/jpackage
#
matrix:
  include:
    - os: linux
      env:
        - JPACKAGE_DOWNLOAD_URL=https://download.java.net/java/early_access/jpackage/49/openjdk-13-jpackage+49_linux-x64_bin.tar.gz
        - JPACKAGE_ARCHIVE_NAME=openjdk-13-jpackage+49_linux-x64_bin.tar.gz
        - BADASS_JLINK_JPACKAGE_HOME=/home/travis/build/Akman/java-boilerplate-gradle/jdk-13
#    - os: osx
#      env:
#        - JPACKAGE_DOWNLOAD_URL=https://download.java.net/java/early_access/jpackage/49/openjdk-13-jpackage+49_osx-x64_bin.tar.gz
#        - JPACKAGE_ARCHIVE_NAME=openjdk-13-jpackage+49_osx-x64_bin.tar.gz
#        - BADASS_JLINK_JPACKAGE_HOME=/Users/travis/build/Akman/java-boilerplate-gradle/jdk-13.jdk/Contents/Home

language: java

sudo: false

jdk:
  - openjdk11

before_install:
  - wget $JPACKAGE_DOWNLOAD_URL

install:
  - chmod a+x ./gradlew
  - pwd
  - gunzip -c $JPACKAGE_ARCHIVE_NAME | tar xopf -
  - ls -al

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
#    - $HOME/.gradle
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/

script:
  - ./gradlew --info --stacktrace check
  - ./gradlew jacocoTestReport
#  - ./gradlew --info --stacktrace jlinkZip jpackage

after_success:
  - bash <(curl -s https://codecov.io/bash)

# deploy:
#   provider: pages
#   skip-cleanup: true
#   github-token: $GITHUB_TOKEN
#   keep-history: false
#   target-branch: images
#   local-dir: build/image-zip
#   on:
#     branch: master
